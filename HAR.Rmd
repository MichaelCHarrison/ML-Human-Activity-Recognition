Human Activity Recognition

```{r, warning=FALSE}
library(caret)
library(data.table)

training <- fread("pml-training.csv")
testing <- fread("pml-testing.csv")
```

*Tidying Data*
```{r, cache=TRUE}
trainingPrime <- t(na.omit(t(training)))
trainingPrime <- trainingPrime[, -c(1:7)]
toDrop <- c("^kurtosis*","^skewness*","yaw")
trainingPrime <- trainingPrime[, -grep(paste(toDrop, collapse = "|"),
                                       colnames(trainingPrime))]
trainingPrime <- as.data.table(trainingPrime)
```
```{r}
trainingPrime[,1:48] <- trainingPrime[, lapply(trainingPrime[,1:48], as.numeric)]
trainingPrime$classe <- as.factor(trainingPrime$classe)
dim(trainingPrime)
```


*First Cross Validation - Random Forest*
```{r}
set.seed(1704111)
inTrain <- createDataPartition(y=trainingPrime$classe,
                               p=.75, list=FALSE)
training1 <- trainingPrime[inTrain,]
testing1 <- trainingPrime[-inTrain,]
x <- training1[,-49]
y <- training1[,49]
```

*Configuring parallel processing*
```{r}
library(parallel)
library(doParallel)
cluster <- makeCluster(detectCores()-1)
registerDoParallel(cluster)
```

*Configure trainControl object*
```{r}
fitControl <- trainControl(method = "cv",
                           number = 10,
                           allowParallel = TRUE)
```


```{r}
fit1 <- train(classe~., data=training1, 
                method="rf", trControl = fitControl)
stopCluster(cluster)
registerDoSEQ()
fit1
```
```{r}
fit1$resample
```
```{r}
confusionMatrix(fit1)
```

*Applying randomForest model to testing set*
```{r}

```

*Second Model - Boosting*
```{r}
cluster <- makeCluster(detectCores()-1)
registerDoParallel(cluster)
fit2 <- train(classe~., data=training1,
              method = "glm", trControl = fitControl)
stopCluster(cluster)
registerDoSEQ()
fit2
```

```{r}
set.seed(1704113)
training3 <- trainingPrime
inTrainCV3 <- createDataPartition(y=training3$classe,
                                  p=.7, list=FALSE)
trainingCV3 <- training1[inTrainCV3,]
testingCV3 <- training1[-inTrainCV3,]
```