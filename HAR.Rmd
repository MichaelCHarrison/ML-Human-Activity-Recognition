Human Activity Recognition

```{r, warning=FALSE}
library(data.table)
library(caret)
library(ggplot2)
library(data.table)
library(GGally)

training <- fread("pml-training.csv")
testing <- fread("pml-testing.csv")
```
```{r}
dim(training)
```
```{r}
dim(testing)
```

Remove columns containing NAs
```{r, cache=TRUE}
trainingPrime <- t(na.omit(t(training)))
trainingPrime <- trainingPrime[, -c(1:7)]
toDrop <- c("^kurtosis*","^skewness*","yaw")
trainingPrime <- trainingPrime[, -grep(paste(toDrop, collapse = "|"),
                                       colnames(trainingPrime))]
trainingPrime <- as.data.table(trainingPrime)
```
```{r}
trainingPrime[,1:48] <- trainingPrime[, lapply(trainingPrime[,1:48], as.numeric)]
trainingPrime$classe <- as.factor(trainingPrime$classe)
dim(trainingPrime)
```


*First Cross Validation - Random Forest*
```{r}
set.seed(1704111)
inTrain <- createDataPartition(y=trainingPrime$classe,
                                  p=.75, list=FALSE)
training1 <- training[inTrain,]
testing1 <- training[-inTrain,]
x <- training1[,-49]
y <- training1[,49]
```

*Configuring parallel processing*
```{r, results='hide'}
library(parallel)
library(doParallel)
cluster <- makeCluster(detectCores()-1)
registerDoParallel
```

*Configure trainControl object*
```{r}
fitControl <- trainControl(method = "cv",
                           number = 10,
                           allowParallel = TRUE)
```


```{r}
fit1 <- train(x, y, data=trainingPrime, 
                method="rf", trControl = fitControl)
stopCluster(cluster)
registerDoSEQ()
```

```{r}

```


*Second Cross Validation - Boosting*
```{r}
set.seed(1704112)
training2 <- trainingPrime
inTrainCV2 <- createDataPartition(y=training2$classe,
                                  p=.7, list=FALSE)
trainingCV2 <- training1[inTrainCV2,]
testingCV2 <- training1[-inTrainCV2,]
```

```{r}
set.seed(1704113)
training3 <- trainingPrime
inTrainCV3 <- createDataPartition(y=training3$classe,
                                  p=.7, list=FALSE)
trainingCV3 <- training1[inTrainCV3,]
testingCV3 <- training1[-inTrainCV3,]
```